<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <title>Text Classification</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen p-5">

  <!-- Header -->
  <div class="flex justify-between items-center mb-7">
    <div class="flex items-center gap-2">
      <div class="w-6 h-6 bg-gray-600 rounded flex items-center justify-center text-white text-xs font-bold">T</div>
      <div>
        <div id="pageTitle" class="text-2xl font-semibold text-gray-800">Text.txt</div>
        <div class="text-gray-500 text-sm mt-1">Text Classification</div>
      </div>
    </div>
    <div class="flex gap-3">
      <button
        class="px-4 py-2 border border-gray-300 bg-white rounded-lg cursor-pointer text-base flex items-center gap-2 hover:bg-gray-100"
        onclick="goBack()">‚Üê Back to project</button>
      <button
        class="px-4 py-2 border border-gray-900 bg-gray-900 text-white rounded-lg cursor-pointer text-base flex items-center gap-2 hover:bg-gray-700"
        onclick="saveAnnotation()">üîí Save Annotation</button>
    </div>
  </div>

  <!-- Main Layout -->
  <div class="flex flex-col lg:flex-row gap-8 min-h-[500px] w-full">

    <!-- Text Area Left -->
    <div class="flex-1 bg-white border border-gray-300 rounded-xl p-8 relative min-h-[600px] flex flex-col justify-center items-center">
      <div class="uploaded-file hidden pb-5 bg-green-50 border border-green-200 rounded mb-4 w-full" id="uploadedFile">
        <div class="font-semibold text-green-700" id="fileName"></div>
      </div>

      <div
        id="uploadArea"
        class="upload-area border-2 border-dashed border-gray-300 rounded-xl flex flex-col justify-center items-center hover:border-blue-400 hover:bg-blue-50 w-full h-[400px] lg:h-[480px] cursor-pointer"
        onclick="document.getElementById('fileInput').click()">
        <div class="text-lg text-gray-500 mb-3">Text box</div>
        <p class="text-gray-400 text-sm">Click here to upload a text file</p>
      </div>

      <textarea
        id="textContent"
        class="text-content hidden w-full h-[400px] lg:h-[480px] border-none outline-none text-base leading-relaxed resize-y mt-4"
        placeholder="Your text content will appear here..."></textarea>
      <input type="file" id="fileInput" class="file-input hidden" accept=".txt,.doc,.docx" onchange="handleFileUpload(event)" />
      <div class="progress-info absolute bottom-5 right-7 text-xs text-gray-500 hidden" id="progressInfo">0/200 texts annotated</div>
    </div>

    <!-- Sidebar Right -->
    <div class="flex flex-col min-w-[320px] w-full lg:max-w-[410px] gap-0">
      <!-- Annotation Tools Frame -->
      <div class="shadow-lg bg-blue-50 border border-blue-100 rounded-2xl px-7 py-6 mb-7">
        <div class="w-full">
          <div class="flex items-center gap-3 pb-4 border-b border-blue-100 mb-4">
            <!-- SVG ICON -->
            <svg svg class="w-5 h-5 text-orange-400" fill="currentColor" viewBox="0 0 20 20">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2z"></path>
              <line x1="8" y1="9" x2="8" y2="9"></line>
              <line x1="12" y1="9" x2="12" y2="9"></line>
              <line x1="16" y1="9" x2="16" y2="9"></line>
            </svg>
            <span class="font-semibold text-gray-800 text-lg">Annotation Tools</span>
          </div>
          <div class="mt-3">
            <div class="text-base font-semibold text-gray-700 mb-3">Identify Entities</div>
            <button 
                id="btn-pos" 
                data-sent="business" 
                class="entities-btn w-full py-3 px-5 mb-3 bg-gray-900 text-white border-2 border-gray-900 text-base rounded-lg hover:bg-gray-700" 
                onclick="selectEntity(this, 'business')">
                Business
            </button>
            <button 
                id="btn-neu" 
                data-sent="sports" 
                class="entities-btn w-full py-3 px-5 mb-3 bg-gray-900 text-white border-2 border-gray-900 text-base rounded-lg hover:bg-gray-700" 
                onclick="selectEntity(this, 'sports')">
                Sports
            </button>
            <button 
                id="btn-pol" 
                data-sent="politics" 
                class="entities-btn w-full py-3 px-5 mb-3 bg-gray-900 text-white border-2 border-gray-900 text-base rounded-lg hover:bg-gray-700" 
                onclick="selectEntity(this, 'politics')">
                Politics
            </button>
            <button 
                id="btn-tech" 
                data-sent="technology" 
                class="entities-btn w-full py-3 px-5 mb-3 bg-gray-900 text-white border-2 border-gray-900 text-base rounded-lg hover:bg-gray-700" 
                onclick="selectEntity(this, 'technology')">
                Technology
            </button>
            <button 
                class="action-btn w-full py-3 px-5 mb-3 bg-gray-900 text-white border-2 border-gray-900 text-base rounded-lg hover:bg-gray-700" 
                onclick="saveCurrentAnnotation()">
                Save Annotation
            </button>
            <button 
                class="action-btn w-full py-3 px-5 bg-gray-900 text-white border-2 border-gray-900 text-base rounded-lg hover:bg-gray-700" 
                onclick="nextText()">
                Next Text
            </button>
          </div>
        </div>
      </div>

      <!-- Shortcuts Section Below Tools -->
      <div class="px-3 py-2 mt-2">
        <div class="text-lg font-semibold text-gray-700 mb-3">Shortcuts</div>
        <div id="sc-pos" data-sent="business" class="shortcut-item flex items-center gap-3 mb-2 cursor-pointer select-none">
          <div class="shortcut-key bg-gray-200 px-4 py-1 rounded text-base font-bold min-w-[36px] text-center">1</div>
          <span class="text-base">‚Üí Business</span>
        </div>
        <div id="sc-neu" data-sent="sports" class="shortcut-item flex items-center gap-3 mb-2 cursor-pointer select-none">
          <div class="shortcut-key bg-gray-200 px-4 py-1 rounded text-base font-bold min-w-[36px] text-center">2</div>
          <span class="text-base">‚Üí Sports</span>
        </div>
        <div id="sc-pol" data-sent="politics" class="shortcut-item flex items-center gap-3 mb-2 cursor-pointer select-none">
          <div class="shortcut-key bg-gray-200 px-4 py-1 rounded text-base font-bold min-w-[36px] text-center">3</div>
          <span class="text-base">‚Üí Politics</span>
        </div>
        <div id="sc-tech" data-sent="technology" class="shortcut-item flex items-center gap-3 mb-2 cursor-pointer select-none">
          <div class="shortcut-key bg-gray-200 px-4 py-1 rounded text-base font-bold min-w-[36px] text-center">4</div>
          <span class="text-base">‚Üí Technology</span>
        </div>
      </div>
    </div>
  </div>

  <script>
    let currentSentiment = "";
    let annotatedCount = 0;
    const totalTexts = 200;

    // File upload handler
    function handleFileUpload(event) {
      const file = event.target.files[0];
      if (!file) return;
      document.getElementById("fileName").textContent = file.name;
      document.getElementById("pageTitle").textContent = file.name;
      document.getElementById("uploadedFile").style.display = "block";
      document.getElementById("uploadArea").style.display = "none";
      document.getElementById("textContent").style.display = "block";
      document.getElementById("progressInfo").style.display = "block";
      const reader = new FileReader();
      reader.onload = (e) => {
        document.getElementById("textContent").value = e.target.result;
      };
      reader.readAsText(file);
    }

    // Drag & drop logic
    const uploadArea = document.getElementById("uploadArea");
    uploadArea.addEventListener("dragover", (e) => {
      e.preventDefault();
      uploadArea.classList.add("ring-2", "ring-blue-400", "bg-blue-50");
    });
    uploadArea.addEventListener("dragleave", (e) => {
      e.preventDefault();
      uploadArea.classList.remove("ring-2", "ring-blue-400", "bg-blue-50");
    });
    uploadArea.addEventListener("drop", (e) => {
      e.preventDefault();
      uploadArea.classList.remove("ring-2", "ring-blue-400", "bg-blue-50");
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        document.getElementById("fileInput").files = files;
        handleFileUpload({ target: { files } });
      }
    });

    // Entity select & shortcut highlight
    function selectEntity(button, entity) {
      document.querySelectorAll(".entities-btn").forEach((b) =>
        b.classList.remove("bg-gray-900", "text-white", "border-blue-700", "selected")
      );
      button.classList.add("bg-gray-900", "text-white", "border-blue-700", "selected");
      currentSentiment = entity;
      highlightShortcut(entity);
    }

    // Shortcuts click logic
    document.querySelectorAll(".shortcut-item").forEach((item) => {
      item.addEventListener("click", () => {
        selectShortcut(item);
      });
    });

    // Shortcut select function
    function selectShortcut(item) {
      // Remove selected highlight from all shortcut items and keys
      document.querySelectorAll(".shortcut-item").forEach((i) =>
        i.classList.remove("selected")
      );
      document.querySelectorAll(".shortcut-key").forEach((k) =>
        k.classList.remove("bg-gray-900", "text-white")
      );
      // Add active highlight to clicked shortcut
      item.classList.add("selected");
      item.querySelector(".shortcut-key").classList.add("bg-gray-900", "text-white");
      // Simulate click on matching entity button
      const sent = item.dataset.sent;
      const map = {
        business: "#btn-pos",
        sports: "#btn-neu",
        politics: "#btn-pol",
        technology: "#btn-tech",
      };
      const target = document.querySelector(map[sent]);
      if (target) target.click();
    }

    // Keyboard shortcut handler for keys 1, 2, 3, 4
    document.addEventListener("keydown", (e) => {
      if (e.key === "1") {
        e.preventDefault();
        selectShortcut(document.getElementById("sc-pos"));
      } else if (e.key === "2") {
        e.preventDefault();
        selectShortcut(document.getElementById("sc-neu"));
      } else if (e.key === "3") {
        e.preventDefault();
        selectShortcut(document.getElementById("sc-pol"));
      } else if (e.key === "4") {
        e.preventDefault();
        selectShortcut(document.getElementById("sc-tech"));
      }
    });

    // Highlight shortcut based on selection
    function highlightShortcut(sent) {
      document.querySelectorAll(".shortcut-item").forEach((i) =>
        i.classList.remove("selected")
      );
      document.querySelectorAll(".shortcut-key").forEach((k) =>
        k.classList.remove("bg-gray-900", "text-white")
      );

      if (sent === "business") {
        document.getElementById("sc-pos").classList.add("selected");
        document
          .getElementById("sc-pos")
          .querySelector(".shortcut-key")
          .classList.add("bg-gray-900", "text-white");
      } else if (sent === "sports") {
        document.getElementById("sc-neu").classList.add("selected");
        document
          .getElementById("sc-neu")
          .querySelector(".shortcut-key")
          .classList.add("bg-gray-900", "text-white");
      } else if (sent === "politics") {
        document.getElementById("sc-pol").classList.add("selected");
        document
          .getElementById("sc-pol")
          .querySelector(".shortcut-key")
          .classList.add("bg-gray-900", "text-white");
      } else if (sent === "technology") {
        document.getElementById("sc-tech").classList.add("selected");
        document
          .getElementById("sc-tech")
          .querySelector(".shortcut-key")
          .classList.add("bg-gray-900", "text-white");
      }
    }


    // Save and next logic
    function saveCurrentAnnotation() {
      if (!currentSentiment) {
        alert("Please select an entity first");
        return;
      }
      annotatedCount++;
      document.getElementById(
        "progressInfo"
      ).textContent = `${annotatedCount}/${totalTexts} texts annotated`;
      alert(`Annotation saved: ${currentSentiment}`);
    }

    function nextText() {
      // Clear previous selection highlight on buttons but keep the selected one
      document.querySelectorAll(".entities-btn").forEach((b) =>
        b.classList.remove("bg-gray-900", "text-white", "border-blue-700", "selected")
      );
      if (currentSentiment) {
        const selBtn = document.querySelector(`#btn-${currentSentiment.slice(0, 3)}`);
        if (selBtn) {
          selBtn.classList.add("bg-gray-900", "text-white", "border-blue-700", "selected");
        }
      }
      // Keep shortcut highlight consistent with currentSentiment
      highlightShortcut(currentSentiment);

      // You can add your logic to load next text here
      console.log("Loading next text...");
    }

    function saveAnnotation() {
      alert("All annotations saved successfully!");
    }

    function goBack() {
      window.location.href = "/frontend/Datasets.html";
    }
  </script>
</body>
</html>